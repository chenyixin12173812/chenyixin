# 7 层负载均衡

4层->7层->业务服务器

7层负载均衡实现的**手段主要有nginx和haprooxy**。

分工：

1 4层主要负责4层的负载均衡，高可用（多AZ，多地区部署）

2 7 层主要负责 流控、过载保护，灰度发布，反向代理，动态路由。

一般4层负载能力是大于7层负载均衡的，所以**7 层负载均衡的节点数要大于4层负载均衡节点的个数**。

一般做成管理平台，完成灰度发布管理，还需要7层负载节点扩容。

7层负载服务化，业务对外提供的转发服务，一个对外端口被视为一个7层负载服务。

# 一 自研组件

# 1 调优

开启网卡的多队列功能，

开启虚拟机的中断发散能力。

# 2 基本原理

基于openresty实现，（限流、灰度、灰度、动态路由

![7层 (7 层负载均衡.assets/7层 (1).png)](C:/Users/chen/Downloads/7层 (1).png)