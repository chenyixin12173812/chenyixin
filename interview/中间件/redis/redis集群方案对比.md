



**1.1、redis 4.0 cluster**

redis 4.0版本的集群是去中心化的结构，集群元数据信息分布在每个节点上，主备切换依赖于多个节点协商选主。 redis 提供了redis-trib 工具做部署集群及运维等操作。 客户端访问散列的db节点需依赖smart client，也就是客户端需要对redis返回的节点信息做判断选择路由等操作。例如客户端请求一个节点，如果所请求的key不在该节点上，客户端需要判断返回的move或ask等指令，重定向请求到对应的节点。

**1.2、codis**

codis由3大组件构成：

- codis-server : 修改过源码的redis, 支持slot，扩容迁移等
- codis-proxy : 支持多线程，go语言实现的内核
- codis Dashboard : 集群管理工具

提供web图形界面管理集群。 集群元数据存在在zookeeper或etcd。 提供独立的组件codis-ha负责redis节点主备切换。 基于proxy的codis，客户端对路由表变化无感知。客户端需要从codis dashhoard调用list proxy命令获取所有proxy列表，并根据自身的轮询策略决定访问哪个proxy节点以实现负载均衡。



1.3、 主从高可用（该方案就是单实例形式，只是为了保证数据的安全，对于用户数据少，业务的前期可以采用，目前我司缓存架构就是采用该方案）

1.4、 客户端分片（典型代表：Jedis。自主写分片算法，代码掌握在自己手中，可控性强，但是需要专业的开发运维人员维护，技术要求和维护成本高）

1.5、代理分片（典型代表：Twemproxy，redis集群没有正式推出之前官网推荐的方案，也是目前使用最多的）

1.6、 Redis cluster（3版本推出的集群方案，历时四年之多的开发）

1.7、 Codis集群（豌豆荚15年开源的解决方案，开源之前其已经用了2年之多，与其同期官网推出redis cluster）

6、 各大互联网公司自主研发的集群架构，但是还没有开源，可能也不会开源





**1.3、阿里云redis**

阿里云的redis集群版由3大组件构成：

- redis-config : 集群管理工具
- redis-server : 优化过源码的redis，支持slot, 扩容迁移等
- redis-proxy : 单线程，c++14语言实现的内核

redis-proxy 无状态，一个集群根据集群规格可挂多个proxy节点。 redis-config 双节点，支持容灾。 集群元数据存储在rds db上。 提供独立的组件HA负责集群的主备切换等。 阿里云的redis集群同样基于proxy，用户对路由信息无感知，同时提供vip给客户端访问，客户端只需一个连接地址即可，无须关心proxy访问的负载均衡等。

